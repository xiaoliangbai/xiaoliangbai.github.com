---
layout: post
title: Hough Transform Lines (Octave)
date: '2016-10-20T15:26:00.001-07:00'
author: Xiaoliang Bai
tags: 
modified_time: '2016-10-20T15:32:52.914-07:00'
thumbnail: https://1.bp.blogspot.com/-qfLHzsmEEoM/WAk7LqufMVI/AAAAAAAAI1I/eJnZnaWwG28WC_26AKOYnEzaPiRzUdzDwCLcB/s72-c/simple_example.png
blogger_id: tag:blogger.com,1999:blog-622863892871609087.post-2375342134041696864
blogger_orig_url: http://xiaoliangbai.blogspot.com/2016/10/hough-transform-lines-octave.html
---

Hough transform was developed to detect lines in 2D pictures.<br />This post documents simple examples and results I got while working on UD810.<br /><br />Functions implemented:<br /><ul><li>hough_lines_acc(img_edgs, rho_resolution, theta_resolution)</li><li>hough_peaks(Hough_acc, NHoodSize)</li><li>hough_lines_draw(img, output, peaks, rho, theta)</li></ul><br />&nbsp;% create an example array<br />img = zeros(200, 200);<br /><br />% Add lines<br />img(50*200+50 : 201 : 150*200 +150) = 255;<br />img(50*200+150 : 199 : 150*200 + 50) = 255;<br /><br />% converting to gray image<br />I = mat2gray(img);<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qfLHzsmEEoM/WAk7LqufMVI/AAAAAAAAI1I/eJnZnaWwG28WC_26AKOYnEzaPiRzUdzDwCLcB/s1600/simple_example.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="150" src="https://1.bp.blogspot.com/-qfLHzsmEEoM/WAk7LqufMVI/AAAAAAAAI1I/eJnZnaWwG28WC_26AKOYnEzaPiRzUdzDwCLcB/s200/simple_example.png" width="200" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />% extract edges using Canny operator<br />edges = edge(I, 'canny');<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-IpR6t_PYaMo/WAk7kTe1UXI/AAAAAAAAI1M/KQvbiIhl6bUKt08oYzLGPU55WVeGWFyzQCLcB/s1600/simple_edges.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="150" src="https://4.bp.blogspot.com/-IpR6t_PYaMo/WAk7kTe1UXI/AAAAAAAAI1M/KQvbiIhl6bUKt08oYzLGPU55WVeGWFyzQCLcB/s200/simple_edges.png" width="200" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />% Hough Transform<br />[H, T, R] = hough_lines_acc(edges);<br />% The tricky part of implementing this function is<br />% to handle negative values: <br />% rhos and thetas can be positive and negative<br />% but array index must be positive <br /><br />% plot voting lines in Hough domain<br />fig1 = figure 1;<br />imagesc(H);<br />saveas(fig1,'lines_in_hough_domain.png'); <br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-I-FNIk0lFcM/WAk5gIDwtMI/AAAAAAAAI08/0oUIh12pWNMQT8fCiAJ1kiG1YpjWc7uEQCLcB/s1600/lines_in_hough_domain.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="241" src="https://1.bp.blogspot.com/-I-FNIk0lFcM/WAk5gIDwtMI/AAAAAAAAI08/0oUIh12pWNMQT8fCiAJ1kiG1YpjWc7uEQCLcB/s320/lines_in_hough_domain.png" width="320" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />% Plot hough lines&nbsp; <br />% Don't forget use cosd and sind because Theta is in degree <br />hough_lines_draw(I, 'output.png', P, R, T);<br /><br />% calculate peaks<br />% This function not only sort and pick the top peaks<br />% but also needs to eliminate neighbours (nHoodSize, an odd parameter)<br />% for each peaks found<br />% The tricky part is to handle boundary condition, rest is straightforward<br /><br />P = hough_peaks(H,2) % since we know there are two lines in this example<br /><br /><br />% Plot outputs from each step<br /><a href="https://1.bp.blogspot.com/-WNeyIUU_8aE/WAk51gp60bI/AAAAAAAAI1E/gSgUYz-H1vYrpwbdOdkOYvPTavDOh9laACLcB/s1600/output.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="241" src="https://1.bp.blogspot.com/-WNeyIUU_8aE/WAk51gp60bI/AAAAAAAAI1E/gSgUYz-H1vYrpwbdOdkOYvPTavDOh9laACLcB/s320/output.png" width="320" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />% Try the flow on football field photo<br />img = imread('football-field.jpeg');<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-7gp8DJZYPcg/WAlAfj2nThI/AAAAAAAAI1c/Wjm1YR1UD6Y10_VXznGa48ANwQTRXV1twCLcB/s1600/football-field.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="78" src="https://2.bp.blogspot.com/-7gp8DJZYPcg/WAlAfj2nThI/AAAAAAAAI1c/Wjm1YR1UD6Y10_VXznGa48ANwQTRXV1twCLcB/s200/football-field.jpeg" width="200" /></a></div><br /><br /><br /><br /><br /><br />% Converting to gray image, then extract edges<br />I2 = rgb2gray(img);<br /><div class="separator" style="clear: both; text-align: center;"><br /></div>edges = edge(I2, 'canny')<br />[H, R, T] = hough_lines_acc(edges);<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-qNV7D-J-JW4/WAlB9hyDjPI/AAAAAAAAI1g/bmAVPkNeFeI-1pthV0sK_8cpCoqJjHYxgCLcB/s1600/football-field-edges.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="240" src="https://4.bp.blogspot.com/-qNV7D-J-JW4/WAlB9hyDjPI/AAAAAAAAI1g/bmAVPkNeFeI-1pthV0sK_8cpCoqJjHYxgCLcB/s320/football-field-edges.png" width="320" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />%Plot Hough Domain<br />imagesc(H);<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-89FMFiPpg0w/WAlCw9ScW7I/AAAAAAAAI1k/fH0--wXmtnYlbbW_toFdNF7MR2RqV507QCLcB/s1600/football-field-hough-vote.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="150" src="https://2.bp.blogspot.com/-89FMFiPpg0w/WAlCw9ScW7I/AAAAAAAAI1k/fH0--wXmtnYlbbW_toFdNF7MR2RqV507QCLcB/s200/football-field-hough-vote.png" width="200" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />P = hough_peaks(H,20);<br />% draw original image, lines and Hough lines<br />hough_lines_draw(I2, 'football_output.png', P, R, T);<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><br /></div>